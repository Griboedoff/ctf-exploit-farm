#!/usr/bin/env python3

import asyncio

from farm.exploits import AbstractExploit


class TcpExploit(AbstractExploit):
    async def attack(self, hostname):
        reader, writer = await asyncio.open_connection(hostname, 8888)

        self.logger.info('Send "hello"')
        writer.write(b'hello\n')

        line = await reader.read(100)
        self.logger.info(f'Received line "{line}"')

        # Don't forget to close connection
        writer.close()

        return 'Test data U2M3QHS8VCH73R13ALX6R52LCO3E0UJ= flags-flags-flags GUDOITWYX4NSIM88KC23AQRWYDF2MPI='


if __name__ == '__main__':
    from farm.farms import Farm
    Farm.debug_exploit(TcpExploit(), '127.0.0.1')
