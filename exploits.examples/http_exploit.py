#!/usr/bin/env python3

import re
import aiohttp

from farm.exploits import AbstractExploit


class HttpExploit(AbstractExploit):
    async def attack(self, hostname):
        async with aiohttp.ClientSession() as session:
            async with session.get('https://en.wikipedia.org/wiki/Dog') as resp:
                self._logger.info('HTTP status is %d' % resp.status)
                text = await resp.text()

                count = re.findall(r'dog', text)
                self._logger.info('Dog exploit: found %d words "dog"' % len(count))

        return 'Test data U2M3QHS8VCH73R13ALX6R52LCO3E0UJ= flags-flags-flags GUDOITWYX4NSIM88KC23AQRWYDF2MPI='
