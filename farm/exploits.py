from farm.logging import Logger


class AbstractExploit:
    _subclasses = []

    def __init__(self):
        self._logger = Logger(self, 'exploits')

    async def attack(self, hostname):
        raise NotImplementedError('Can\'t attack host %s: %s doesn\'t specify attack(hostname)' % (hostname, self.__class__.__name__))

    def __init_subclass__(cls, **kwargs):
        AbstractExploit._subclasses.append(cls)

    @classmethod
    def clear_subclasses(cls):
        cls._subclasses.clear()

    @classmethod
    def get_all_subclasses(cls):
        return cls._subclasses

    def __str__(self):
        return self.__class__.__name__
